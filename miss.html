<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ö–æ–≥–¥–∞ —Ç—ã —Å–∫—É—á–∞–µ—à—å –ø–æ –º–Ω–µ</title>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<div id="bg-hearts"></div>
<div id="stars"></div>

<div class="container miss-page">
  <nav class="top-nav">
    <div class="nav-links">
      <a href="index.html" class="nav-link">–ñ–µ–ª–∞–Ω–∏—è</a>
      <a href="thoughts.html" class="nav-link">–ú—ã—Å–ª–∏</a>
      <a href="miss.html" class="nav-link nav-active">–ö–æ–≥–¥–∞ —Å–∫—É—á–∞–µ—à—å</a>
      <a href="letter.html" class="nav-link">–ü–∏—Å—å–º–æ</a>
      <a href="about.html" class="nav-link">–û –Ω–∞—Å</a>
    </div>
    <button type="button" class="theme-toggle" onclick="toggleTheme()">üåô</button>
  </nav>

  <div class="title-row">
    <div class="lock-icon">üîí</div>
    <h1>–ö–æ–≥–¥–∞ —Ç—ã —Å–∫—É—á–∞–µ—à—å –ø–æ –º–Ω–µ üí´</h1>
  </div>

  <!-- –ü–µ—á–∞—Ç–∞—é—â–∞—è—Å—è —Å—Ç—Ä–æ–∫–∞ -->
  <p id="typing-text" class="typing-line"></p>

  <p class="letter-text">
    –ï—Å–ª–∏ —Ç–µ–±–µ –≥—Ä—É—Å—Ç–Ω–æ –∏–ª–∏ —Ç—ã —Å–∫—É—á–∞–µ—à—å ‚Äî –∑–∞—Ö–æ–¥–∏ —Å—é–¥–∞. –ó–¥–µ—Å—å –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –∫—É—Å–æ—á–µ–∫ –º–µ–Ω—è
    –∏ –º–µ—Å—Ç–æ, –≥–¥–µ —Ç—ã –º–æ–∂–µ—à—å —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å, –∫–∞–∫ –ø—Ä–æ—à—ë–ª —Ç–≤–æ–π –¥–µ–Ω—å.
  </p>

  <!-- –§–æ—Ç–æ / –≥–∞–ª–µ—Ä–µ—è -->
  <div class="miss-media">
    <div>
      <div class="miss-photo-frame">
        <img id="miss-main-photo" src="secret-photo.jpg" alt="–ù–∞—à–µ –¥–µ—Ç—Å–∫–æ–µ —Ñ–æ—Ç–æ" />
        <div class="miss-photo-overlay">
          <span id="miss-quote"></span>
        </div>
      </div>

      <div class="photo-controls">
        <button type="button" class="photo-nav-btn" onclick="prevPhoto()">‚üµ</button>
        <div class="photo-dots" id="photo-dots"></div>
        <button type="button" class="photo-nav-btn" onclick="nextPhoto()">‚ü∂</button>
      </div>

      <p class="secret-caption">
        –ö–æ–≥–¥–∞ —Ç—ã –±—É–¥–µ—à—å —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —ç—Ç–æ —Ñ–æ—Ç–æ, –ø—Ä–æ—Å—Ç–æ –ø–æ–º–Ω–∏:
        –≥–¥–µ –±—ã —è –Ω–∏ –±—ã–ª, —á–∞—Å—Ç—å—é –º–µ–Ω—è —è –≤—Å—ë —Ä–∞–≤–Ω–æ —Å–∏–∂—É –∑–¥–µ—Å—å –∏ –¥—É–º–∞—é –æ —Ç–µ–±–µ.
      </p>
    </div>

    <!-- –ì–æ–ª–æ—Å / –º—É–∑—ã–∫–∞ / —á–∞—Ç -->
    <div>
      <div class="voice-block">
        <!-- –ù–∞—à–∞ –ø–µ—Å–Ω—è Mockingbird -->
        <div class="song-block">
          <h3>–ù–∞—à–∞ –ø–µ—Å–Ω—è ‚Äî Mockingbird üñ§</h3>
          <p class="song-text">
            –ö–æ–≥–¥–∞ —Ç–µ–±–µ –æ—Å–æ–±–µ–Ω–Ω–æ —Ç–æ—Å–∫–ª–∏–≤–æ ‚Äî –≤–∫–ª—é—á–∏ —ç—Ç—É –ø–µ—Å–Ω—é.  
            –ü—Ä–æ—Å—Ç–æ –∑–∞–∫—Ä–æ–π –≥–ª–∞–∑–∞ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —è —Å–∏–∂—É —Ä—è–¥–æ–º –∏ –¥–µ—Ä–∂—É —Ç–µ–±—è –∑–∞ —Ä—É–∫—É.
          </p>

          <div class="audio-player" data-audio-id="mockingbird-audio">
            <button type="button" class="audio-play-btn">‚ñ∂</button>
            <div class="audio-track">
              <div class="audio-progress"></div>
            </div>
            <span class="audio-time" data-role="current">0:00</span>
            <span class="audio-time-separator">/</span>
            <span class="audio-time" data-role="duration">0:00</span>
          </div>

          <audio id="mockingbird-audio" src="mockingbird.mp3" preload="metadata"></audio>
        </div>

        <!-- –ù–æ—á–Ω–æ–π —Ä–µ–∂–∏–º + Shape Of My Heart -->
        <div class="night-letter-block">
          <button type="button" class="night-letter-btn" onclick="toggleNightLetter()">
            üåô –ù–æ—á–Ω–æ–π —Ä–µ–∂–∏–º &amp; Shape Of My Heart
          </button>
          <small class="night-hint">–í–∫–ª—é—á–∏, –∫–æ–≥–¥–∞ —Ö–æ—á–µ—à—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–∏—Ö—É—é –∏ —Ç—ë–ø–ª—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É.</small>
          <audio id="night-song" src="shape-of-my-heart.mp3" preload="auto"></audio>
        </div>
      </div>

      <!-- –ß–∞—Ç-–±–æ—Ç -->
      <div class="chat-card">
        <h3>–ß–∞—Ç —Å–æ –º–Ω–æ–π ü§ç</h3>
        <div id="chatMessages" class="chat-messages"></div>
        <div class="chat-input-row">
          <input id="chatInput" type="text" placeholder="–ù–∞–ø–∏—à–∏, –æ —á—ë–º –¥—É–º–∞–µ—à—å..." onkeydown="if(event.key==='Enter'){sendChat()}" />
          <button type="button" onclick="sendChat()">‚û§</button>
        </div>
      </div>
    </div>
  </div>

  <h2>–¢–≤–æ–∏ ¬´—Å–∫—É—á–∞—é¬ª –º—ã—Å–ª–∏:</h2>
  <textarea id="missInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Å–µ–≥–æ–¥–Ω—è –æ—á–µ–Ω—å —Å–∫—É—á–∞—é –ø–æ —Ç–µ–±–µ..."></textarea>
  <button type="button" onclick="addMiss()">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</button>

  <ul id="missList"></ul>
</div>

<div id="hearts"></div>
<div class="corner-lock">üîí –ù–∞—à –º–∞–ª–µ–Ω—å–∫–∏–π —Å–µ–∫—Ä–µ—Ç</div>

<!-- –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–µ —Ñ–æ—Ç–æ -->
<div id="photo-modal" class="photo-modal">
  <div class="photo-modal-backdrop" onclick="closePhotoModal()"></div>
  <div class="photo-modal-content">
    <button type="button" class="photo-modal-close" onclick="closePhotoModal()">‚úï</button>
    <img id="photo-modal-img" src="secret-photo.jpg" alt="–ù–∞—à–µ –¥–µ—Ç—Å–∫–æ–µ —Ñ–æ—Ç–æ" />
    <p class="photo-modal-text">
      –ü—Ä–æ—Å—Ç–æ –º—ã, —á—É—Ç—å –±–ª–∏–∂–µ. –ú–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —ç—Ç–æ —Ñ–æ—Ç–æ –∏ –≤—Å–ø–æ–º–∏–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –≤–ø–µ—Ä–µ–¥–∏.
    </p>
  </div>
</div>

<!-- –°–∫—Ä—ã—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ –∑–∞–º–∫—É -->
<div id="secret-toast" class="secret-toast">
  –ù–∞—Å—Ç–æ—è—â–∏–π —Å–µ–∫—Ä–µ—Ç –Ω–µ –Ω–∞ —ç—Ç–æ–º —Å–∞–π—Ç–µ, –∞ –º–µ–∂–¥—É –Ω–∞–º–∏. ü§ç
</div>

<script>
  /* ===== –¢–ï–ú–ê ===== */
  function applyThemeFromStorage() {
    const saved = localStorage.getItem("theme");
    const body = document.body;
    const toggles = document.querySelectorAll(".theme-toggle");
    if (saved === "dark") {
      body.classList.add("dark");
      toggles.forEach(b => b.textContent = "‚òÄ");
    } else {
      body.classList.remove("dark");
      toggles.forEach(b => b.textContent = "üåô");
    }
  }

  function toggleTheme() {
    const body = document.body;
    const isDark = body.classList.toggle("dark");
    const toggles = document.querySelectorAll(".theme-toggle");
    toggles.forEach(b => b.textContent = isDark ? "‚òÄ" : "üåô");
    localStorage.setItem("theme", isDark ? "dark" : "light");
  }

  /* ===== –§–û–ù: –°–ï–†–î–¶–ê + –ó–í–Å–ó–î–´ ===== */
  function createBgHeart() {
    const container = document.getElementById("bg-hearts");
    if (!container) return;
    const h = document.createElement("div");
    h.className = "bg-heart";
    h.textContent = "üíó";
    const size = 10 + Math.random() * 10;
    h.style.fontSize = size + "px";
    h.style.left = Math.random() * 100 + "%";
    h.style.animationDuration = 7 + Math.random() * 5 + "s";
    h.style.opacity = 0.2 + Math.random() * 0.4;
    container.appendChild(h);
    setTimeout(() => h.remove(), 15000);
  }

  function startBackgroundHearts() {
    for (let i = 0; i < 10; i++) setTimeout(createBgHeart, i * 400);
    setInterval(createBgHeart, 1200);
  }

  function createStars() {
    const container = document.getElementById("stars");
    if (!container) return;
    for (let i = 0; i < 80; i++) {
      const s = document.createElement("div");
      s.className = "star";
      s.style.left = Math.random() * 100 + "%";
      s.style.top = Math.random() * 100 + "%";
      s.style.animationDuration = (3 + Math.random() * 5) + "s";
      s.style.animationDelay = (Math.random() * 5) + "s";
      container.appendChild(s);
    }
  }

  /* ===== –§–†–ê–ó–´ –ù–ê –§–û–¢–û ===== */
  const missPhrases = [
    "–ö–æ–≥–¥–∞ –º–Ω–µ —Ç—è–∂–µ–ª–æ, —è –¥—É–º–∞—é –æ —Ç–µ–±–µ –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ª–µ–≥—á–µ.",
    "–ï—Å–ª–∏ –±—ã —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –∏–∑–º–µ—Ä—è–ª–∏ —á—É–≤—Å—Ç–≤–∞–º–∏, —è –±—ã –≤—Å–µ–≥–¥–∞ –±—ã–ª —Ä—è–¥–æ–º.",
    "–ò–Ω–æ–≥–¥–∞ –º–Ω–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Å–ø–æ–º–Ω–∏—Ç—å —Ç–≤–æ–π –≤–∑–≥–ª—è–¥, —á—Ç–æ–±—ã –¥–µ–Ω—å —Å—Ç–∞–ª –ª—É—á—à–µ.",
    "–¢—ã –¥–∞–∂–µ –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—à—å, –∫–∞–∫ —á–∞—Å—Ç–æ —è –º—ã—Å–ª–µ–Ω–Ω–æ —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞—é —Å —Ç–æ–±–æ–π.",
    "–í –ª—é–±–æ–º –≥–æ—Ä–æ–¥–µ –º–∏—Ä–∞ –º–æ–∏–º –¥–æ–º–æ–º –±—É–¥–µ—Ç –º–µ—Å—Ç–æ, –≥–¥–µ —Ç—ã."
  ];

  function setRandomMissPhrase() {
    const el = document.getElementById("miss-quote");
    if (!el || !missPhrases.length) return;
    const index = Math.floor(Math.random() * missPhrases.length);
    el.textContent = missPhrases[index];
  }

  /* ===== –ì–ê–õ–ï–†–ï–Ø –§–û–¢–û ===== */
  const missPhotos = [
    "secret-photo.jpg"
  ];
  let currentPhoto = 0;

  function updatePhoto() {
    const img = document.getElementById("miss-main-photo");
    const dots = document.getElementById("photo-dots");
    if (!img || !dots) return;

    img.src = missPhotos[currentPhoto] + "?v=1";
    dots.innerHTML = "";

    missPhotos.forEach((_, i) => {
      const dot = document.createElement("span");
      dot.className = "photo-dot" + (i === currentPhoto ? " active" : "");
      dot.onclick = () => {
        currentPhoto = i;
        updatePhoto();
      };
      dots.appendChild(dot);
    });
  }

  function prevPhoto() {
    currentPhoto = (currentPhoto - 1 + missPhotos.length) % missPhotos.length;
    updatePhoto();
  }

  function nextPhoto() {
    currentPhoto = (currentPhoto + 1) % missPhotos.length;
    updatePhoto();
  }

  /* ===== –ó–ê–ü–ò–°–ò ¬´–°–ö–£–ß–ê–Æ¬ª ===== */
  let missNotes = [];

  function saveMiss() {
    localStorage.setItem("missNotes", JSON.stringify(missNotes));
  }

  function renderMiss() {
    const list = document.getElementById("missList");
    list.innerHTML = "";
    missNotes.forEach((item, index) => {
      const li = document.createElement("li");
      const wrap = document.createElement("div");
      wrap.className = "thought-text";

      const main = document.createElement("div");
      main.textContent = item.text;

      const meta = document.createElement("small");
      meta.textContent = item.date;

      wrap.appendChild(main);
      wrap.appendChild(meta);

      const btn = document.createElement("button");
      btn.textContent = "‚úï";
      btn.className = "delete-btn";
      btn.onclick = () => {
        missNotes.splice(index, 1);
        saveMiss();
        renderMiss();
      };

      li.appendChild(wrap);
      li.appendChild(btn);
      list.appendChild(li);
    });
  }

  function addMiss() {
    const input = document.getElementById("missInput");
    const text = input.value.trim();
    if (!text) return;

    const now = new Date();
    const date = now.toLocaleString("ru-RU", {
      day: "2-digit", month: "2-digit", year: "numeric",
      hour: "2-digit", minute: "2-digit"
    });

    missNotes.unshift({ text, date });
    saveMiss();
    renderMiss();
    input.value = "";
  }

  /* ===== –ü–ï–ß–ê–¢–ê–ù–ò–ï –¢–ï–ö–°–¢–ê ===== */
  const typingText = "–ï—Å–ª–∏ —Ç—ã —Å–∫—É—á–∞–µ—à—å, –∑–Ω–∞–π: –º—ã—Å–ª–µ–Ω–Ω–æ —è –≤—Å–µ–≥–¥–∞ —Ä—è–¥–æ–º —Å —Ç–æ–±–æ–π.";
  let typingIndex = 0;

  function typeLine() {
    const el = document.getElementById("typing-text");
    if (!el) return;
    if (typingIndex <= typingText.length) {
      el.textContent = typingText.slice(0, typingIndex);
      typingIndex++;
      setTimeout(typeLine, 60);
    }
  }

  /* ===== –ß–ê–¢-–ë–û–¢ ===== */
  const chatMessages = [];
  const chatReplies = [
    { keywords: ["—Å–∫—É—á", "miss"], answer: "–Ø —Ç–æ–∂–µ —Å–∫—É—á–∞—é –ø–æ —Ç–µ–±–µ —Å–∏–ª—å–Ω–µ–µ, —á–µ–º –º–æ–≥—É –æ–ø–∏—Å–∞—Ç—å —Å–ª–æ–≤–∞–º–∏." },
    { keywords: ["–ª—é–±", "love"], answer: "–Ø –ª—é–±–ª—é —Ç–µ–±—è –±–æ–ª—å—à–µ, —á–µ–º —Ç—ã –¥—É–º–∞–µ—à—å. –ò –∫–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî —á—É—Ç—å —Å–∏–ª—å–Ω–µ–µ." },
    { keywords: ["—É—Å—Ç–∞–ª", "—Ç—è–∂–µ–ª–æ", "–ø–ª–æ—Ö–æ"], answer: "–ï—Å–ª–∏ —Ç–µ–±–µ —Ç—è–∂–µ–ª–æ ‚Äî –ø—Ä–æ—Å—Ç–æ —Ä–∞—Å—Å–∫–∞–∂–∏. –î–∞–∂–µ —á–µ—Ä–µ–∑ —ç–∫—Ä–∞–Ω —è —Ä—è–¥–æ–º —Å —Ç–æ–±–æ–π." },
    { keywords: ["–ø—Ä–∏–≤–µ—Ç"], answer: "–ü—Ä–∏–≤–µ—Ç, –º–æ—è —Ä–æ–¥–Ω–∞—è. –ö–∞–∫ —Ç–≤–æ—ë —Å–µ—Ä–¥–µ—á–∫–æ?" },
    { keywords: ["—Å–ø–∞—Ç—å", "–Ω–æ—á—å"], answer: "–ü–µ—Ä–µ–¥ —Å–Ω–æ–º –ø—Ä–æ—Å—Ç–æ –≤—Å–ø–æ–º–Ω–∏ –Ω–∞—à —Å–º–µ—Ö. –Ø –º—ã—Å–ª–µ–Ω–Ω–æ —Ü–µ–ª—É—é —Ç–µ–±—è –≤ –ª–æ–±." }
  ];

  function renderChat() {
    const box = document.getElementById("chatMessages");
    box.innerHTML = "";
    chatMessages.forEach(msg => {
      const div = document.createElement("div");
      div.className = "chat-bubble " + (msg.from === "you" ? "from-you" : "from-me");
      div.textContent = msg.text;
      box.appendChild(div);
    });
    box.scrollTop = box.scrollHeight;
  }

  function sendChat() {
    const input = document.getElementById("chatInput");
    const text = input.value.trim();
    if (!text) return;

    chatMessages.push({ from: "you", text });
    input.value = "";
    renderChat();

    const lower = text.toLowerCase();
    let answer = "–Ø –ø—Ä–æ—á–∏—Ç–∞–ª. –î–∞–∂–µ –µ—Å–ª–∏ –º–æ–ª—á—É ‚Äî —è —Ä—è–¥–æ–º –∏ —Å–ª—ã—à—É —Ç–µ–±—è. ü§ç";

    for (const rule of chatReplies) {
      if (rule.keywords.some(k => lower.includes(k))) {
        answer = rule.answer;
        break;
      }
    }

    setTimeout(() => {
      chatMessages.push({ from: "me", text: answer });
      renderChat();
    }, 700);
  }

  /* ===== –ù–û–ß–ù–û–ô –†–ï–ñ–ò–ú + SONG ===== */
  let nightOn = false;

  function toggleNightLetter() {
    const body = document.body;
    const song = document.getElementById("night-song");
    nightOn = !nightOn;
    body.classList.toggle("night-letter", nightOn);

    if (nightOn) {
      song.currentTime = 0;
      song.play().catch(() => {});
    } else {
      song.pause();
    }
  }

  /* ==== –ü–û–õ–ù–û–≠–ö–†–ê–ù–ù–û–ï –§–û–¢–û ==== */
  function openPhotoModal() {
    const modal = document.getElementById("photo-modal");
    const img = document.getElementById("photo-modal-img");
    const main = document.getElementById("miss-main-photo");
    if (!modal || !img || !main) return;
    img.src = main.src;
    modal.classList.add("open");
  }

  function closePhotoModal() {
    const modal = document.getElementById("photo-modal");
    if (!modal) return;
    modal.classList.remove("open");
  }

  /* ==== –ü–ê–°–•–ê–õ–ö–ê –ù–ê –ó–ê–ú–ö–ï ==== */
  function toggleSecretToast() {
    const toast = document.getElementById("secret-toast");
    if (!toast) return;
    toast.classList.add("show");
    setTimeout(() => {
      toast.classList.remove("show");
    }, 4000);
  }

  /* ==== –ö–ê–°–¢–û–ú–ù–´–ô –ü–õ–ï–ï–† ==== */

  function formatTime(seconds) {
    if (!isFinite(seconds)) return "0:00";
    const m = Math.floor(seconds / 60);
    const s = Math.floor(seconds % 60);
    return m + ":" + String(s).padStart(2, "0");
  }

  function initCustomAudioPlayers() {
    const players = document.querySelectorAll(".audio-player");
    const allPlayers = players;

    function pauseAllExcept(exceptAudioId) {
      allPlayers.forEach(p => {
        const id = p.dataset.audioId;
        const a = document.getElementById(id);
        const btn = p.querySelector(".audio-play-btn");
        if (a && id !== exceptAudioId) {
          a.pause();
          p.classList.remove("playing");
          if (btn) btn.textContent = "‚ñ∂";
        }
      });
    }

    players.forEach(player => {
      const audioId = player.dataset.audioId;
      const audio = document.getElementById(audioId);
      if (!audio) return;

      const playBtn = player.querySelector(".audio-play-btn");
      const track = player.querySelector(".audio-track");
      const progress = player.querySelector(".audio-progress");
      const curEl = player.querySelector('[data-role="current"]');
      const durEl = player.querySelector('[data-role="duration"]');

      audio.addEventListener("loadedmetadata", () => {
        if (durEl) durEl.textContent = formatTime(audio.duration);
      });

      audio.addEventListener("timeupdate", () => {
        if (curEl) curEl.textContent = formatTime(audio.currentTime);
        if (progress && audio.duration) {
          progress.style.width = (audio.currentTime / audio.duration * 100) + "%";
        }
      });

      audio.addEventListener("ended", () => {
        player.classList.remove("playing");
        if (playBtn) playBtn.textContent = "‚ñ∂";
      });

      if (playBtn) {
        playBtn.addEventListener("click", () => {
          if (audio.paused) {
            pauseAllExcept(audioId);
            audio.play().catch(() => {});
            player.classList.add("playing");
            playBtn.textContent = "‚è∏";
          } else {
            audio.pause();
            player.classList.remove("playing");
            playBtn.textContent = "‚ñ∂";
          }
        });
      }

      if (track) {
        track.addEventListener("click", (e) => {
          if (!audio.duration) return;
          const rect = track.getBoundingClientRect();
          const ratio = (e.clientX - rect.left) / rect.width;
          audio.currentTime = Math.max(0, Math.min(audio.duration, ratio * audio.duration));
        });
      }
    });
  }

  window.addEventListener("load", () => {
    applyThemeFromStorage();
    startBackgroundHearts();
    createStars();
    setRandomMissPhrase();
    updatePhoto();
    typeLine();

    const saved = localStorage.getItem("missNotes");
    if (saved) {
      try { missNotes = JSON.parse(saved); } catch { missNotes = []; }
    }
    renderMiss();

    document.body.classList.add("page-ready");

    const mainPhoto = document.getElementById("miss-main-photo");
    if (mainPhoto) {
      mainPhoto.addEventListener("click", openPhotoModal);
    }

    const lock = document.querySelector(".corner-lock");
    if (lock) {
      lock.addEventListener("click", toggleSecretToast);
    }

    initCustomAudioPlayers();
  });
</script>
</body>
</html>
